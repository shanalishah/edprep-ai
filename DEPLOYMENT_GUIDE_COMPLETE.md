# ðŸš€ IELTS Master Platform - Complete Deployment Guide

## Overview
This guide provides step-by-step instructions to deploy the IELTS Master Platform with Supabase integration for maximum stability and reliability.

## Architecture
- **Frontend**: Next.js on Vercel
- **Backend**: FastAPI on Railway (for AI features)
- **Database & Auth**: Supabase (PostgreSQL + Auth + RLS)

## Prerequisites
1. GitHub repository: `https://github.com/shanalishah/edprep-ai.git`
2. Supabase account and project
3. Vercel account
4. Railway account
5. OpenAI API key (for AI features)

---

## Step 1: Supabase Setup

### 1.1 Create Supabase Project
1. Go to [supabase.com](https://supabase.com)
2. Create new project
3. Note your project URL and anon key

### 1.2 Run Database Schema
1. Go to Supabase Dashboard â†’ SQL Editor
2. Copy and paste the contents of `supabase/schema.sql`
3. Click "Run" to create tables, policies, and functions

### 1.3 Seed Test Users
1. Install Python dependencies:
   ```bash
   pip install supabase
   ```
2. Set environment variables:
   ```bash
   export SUPABASE_URL="https://your-project.supabase.co"
   export SUPABASE_SERVICE_KEY="your-service-key"
   ```
3. Run seeding script:
   ```bash
   python supabase_seed_users.py
   ```

---

## Step 2: Vercel Deployment (Frontend)

### 2.1 Connect Repository
1. Go to [vercel.com](https://vercel.com)
2. Import project from GitHub: `shanalishah/edprep-ai`
3. Set framework to "Next.js"

### 2.2 Configure Environment Variables
In Vercel dashboard â†’ Settings â†’ Environment Variables, add:

```env
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key
NEXT_PUBLIC_AUTH_PROVIDER=supabase
NEXT_PUBLIC_USE_SUPABASE_MENTORSHIP=true
NEXT_PUBLIC_API_URL=https://web-production-4d7f.up.railway.app
```

### 2.3 Deploy
1. Click "Deploy"
2. Wait for build to complete
3. Note your Vercel domain (e.g., `your-app.vercel.app`)

---

## Step 3: Railway Deployment (Backend)

### 3.1 Connect Repository
1. Go to [railway.app](https://railway.app)
2. Create new project from GitHub: `shanalishah/edprep-ai`
3. Select the repository

### 3.2 Configure Service
1. Set root directory to `backend`
2. Set start command to: `uvicorn app.main:app --host 0.0.0.0 --port $PORT`

### 3.3 Configure Environment Variables
In Railway dashboard â†’ Variables, add:

```env
OPENAI_API_KEY=your-openai-api-key
ANTHROPIC_API_KEY=your-anthropic-api-key
DATABASE_URL=postgresql://... (auto-generated by Railway)
BACKEND_CORS_ORIGINS=["http://localhost:3000","https://your-app.vercel.app"]
APP_NAME="IELTS Master Platform"
APP_VERSION="2.1.2"
```

### 3.4 Deploy
1. Railway will auto-deploy
2. Note your Railway domain (e.g., `web-production-4d7f.up.railway.app`)

---

## Step 4: Update Configuration

### 4.1 Update Vercel Environment Variables
Update `NEXT_PUBLIC_API_URL` in Vercel to your Railway domain:
```env
NEXT_PUBLIC_API_URL=https://your-railway-domain.up.railway.app
```

### 4.2 Update Railway CORS
Update `BACKEND_CORS_ORIGINS` in Railway to include your Vercel domain:
```env
BACKEND_CORS_ORIGINS=["http://localhost:3000","https://your-app.vercel.app"]
```

### 4.3 Redeploy Both Services
1. Trigger Vercel redeploy
2. Trigger Railway redeploy

---

## Step 5: Testing

### 5.1 Test Authentication
1. Go to your Vercel domain
2. Click "Log In"
3. Use test credentials:
   - Admin: `admin1@edprep.ai` / `test123`
   - Mentor: `dr.emma.chen@edprep.ai` / `test123`
   - Student: `ahmed.hassan@student.com` / `test123`

### 5.2 Test Mentorship Features
1. Login as student
2. Go to Mentorship page
3. Search for mentors
4. Send connection request
5. Login as mentor
6. Accept connection
7. Test chat functionality

### 5.3 Test Writing Coach
1. Login as student
2. Go to Writing Coach
3. Start a session
4. Test AI responses

---

## Troubleshooting

### Common Issues

#### 1. "Failed to fetch" errors
- Check CORS configuration in Railway
- Verify environment variables are set correctly
- Check Railway backend logs

#### 2. "404: NOT_FOUND" on chat
- Ensure Supabase schema is properly created
- Check if users exist in Supabase Auth
- Verify RLS policies are correct

#### 3. Login not working
- Check Supabase Auth configuration
- Verify environment variables in Vercel
- Check Supabase logs for auth errors

#### 4. No mentors showing
- Run the seeding script again
- Check if mentors have `is_available_for_mentorship=true`
- Verify Supabase profiles table

### Debug Steps
1. Check Vercel function logs
2. Check Railway deployment logs
3. Check Supabase logs
4. Use browser dev tools to inspect network requests

---

## Environment Variables Reference

### Vercel (Frontend)
```env
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key
NEXT_PUBLIC_AUTH_PROVIDER=supabase
NEXT_PUBLIC_USE_SUPABASE_MENTORSHIP=true
NEXT_PUBLIC_API_URL=https://your-railway-domain.up.railway.app
```

### Railway (Backend)
```env
OPENAI_API_KEY=your-openai-api-key
ANTHROPIC_API_KEY=your-anthropic-api-key
DATABASE_URL=postgresql://... (auto-generated)
BACKEND_CORS_ORIGINS=["http://localhost:3000","https://your-app.vercel.app"]
APP_NAME="IELTS Master Platform"
APP_VERSION="2.1.2"
```

### Supabase Seeding Script
```env
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_KEY=your-service-key
```

---

## Production Checklist

- [ ] Supabase project created and schema deployed
- [ ] Test users seeded in Supabase
- [ ] Vercel deployed with correct environment variables
- [ ] Railway deployed with correct environment variables
- [ ] CORS configured correctly
- [ ] Authentication working
- [ ] Mentorship features working
- [ ] Chat functionality working
- [ ] Writing Coach working
- [ ] All test credentials working

---

## Support

If you encounter issues:
1. Check the troubleshooting section above
2. Review logs in Vercel, Railway, and Supabase
3. Verify all environment variables are set correctly
4. Ensure all services are deployed and running

---

**ðŸŽ‰ Congratulations! Your IELTS Master Platform is now deployed and ready for users!**

